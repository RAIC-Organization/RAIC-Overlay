# Data Model: GitHub Release Workflow

**Feature**: 048-github-release-workflow
**Date**: 2026-01-02

## Overview

This feature is a CI/CD workflow configuration with no persistent data storage. The "data model" consists of:
1. **Configuration files** modified during the workflow
2. **Workflow inputs** (tag information)
3. **Workflow outputs** (release artifacts)

## Configuration Entities

### Version Tag (Input)

The git tag that triggers the workflow.

| Attribute | Type | Format | Example |
|-----------|------|--------|---------|
| raw_tag | string | Git ref name | `v0.1.0`, `1.2.3-beta.1` |
| version | string | Semver without prefix | `0.1.0`, `1.2.3-beta.1` |
| is_prerelease | boolean | Contains hyphen | `true` for `-beta`, `false` for stable |

**Derivation Rules**:
- `version` = `raw_tag` with leading `v` stripped
- `is_prerelease` = `version.contains('-')`

### Version Files (Modified)

Three files are updated during the workflow:

#### tauri.conf.json
```json
{
  "version": "<extracted version>"
}
```
- Location: `src-tauri/tauri.conf.json`
- Field: `$.version`
- Format: JSON string

#### package.json
```json
{
  "version": "<extracted version>"
}
```
- Location: `package.json`
- Field: `$.version`
- Format: JSON string

#### Cargo.toml
```toml
[package]
version = "<extracted version>"
```
- Location: `src-tauri/Cargo.toml`
- Field: `package.version`
- Format: TOML string

### Release Artifact (Output)

The MSI installer generated by the Tauri build.

| Attribute | Type | Example |
|-----------|------|---------|
| filename | string | `RAIC Overlay_0.1.0_x64_en-US.msi` |
| path | string | `src-tauri/target/release/bundle/msi/*.msi` |
| content_type | string | `application/x-msi` |

### GitHub Release (Output)

The release created on GitHub.

| Attribute | Type | Source |
|-----------|------|--------|
| tag_name | string | From trigger tag |
| name | string | `v{version}` or `{version}` |
| body | string | Auto-generated changelog |
| prerelease | boolean | Derived from version |
| assets | array | MSI file |

## State Transitions

```
[Tag Pushed]
     │
     ▼
[Version Extracted] ─────────────────────────────┐
     │                                           │
     ▼                                           ▼
[Files Updated]                          [Pre-release Check]
  - tauri.conf.json                              │
  - package.json                                 ▼
  - Cargo.toml                           [prerelease: true/false]
     │                                           │
     ▼                                           │
[Build Executed] ◄───────────────────────────────┘
     │
     ▼
[MSI Generated]
     │
     ▼
[Release Created]
  - Changelog attached
  - MSI uploaded
  - Pre-release flag set
```

## Validation Rules

### Tag Format Validation
- MUST match pattern: `^v?\d+\.\d+\.\d+(-[a-zA-Z0-9.]+)?$`
- Valid: `0.1.0`, `v1.2.3`, `2.0.0-alpha.1`, `v0.1.0-rc.1`
- Invalid: `release-1`, `latest`, `v1`, `1.0`

### Version Consistency
- After update, all three files MUST contain identical version string
- Version string MUST NOT include `v` prefix (files store bare version)

### Artifact Validation
- MSI file MUST exist at expected path after build
- MSI filename MUST contain the version number
